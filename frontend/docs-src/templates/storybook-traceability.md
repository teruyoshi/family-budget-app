# Storybook 仕様トレーサビリティ表 - テンプレート

## 📋 概要
Storybookストーリーに仕様トレーサビリティ表を追加するためのテンプレートです。  
ドキュメント→仕様根拠→テストの関係を明確化し、品質監査・バグ調査の効率を向上させます。

## 🎯 目的
- **品質監査**: 仕様とテストの対応関係を一目で確認
- **バグ調査**: 関連する全資料に素早くアクセス
- **新規参加者**: コンポーネントの背景・意図を理解促進
- **レビュー**: 設計一貫性の確認を効率化

## 📝 テンプレート

```typescript
// ComponentName.stories.tsx
const meta: Meta<typeof ComponentName> = {
  component: ComponentName,
  title: 'カテゴリ/ComponentName',
  tags: ['autodocs'],
  parameters: {
    docs: {
      description: {
        component: `
[コンポーネントの簡潔な説明]
[技術的特徴・アーキテクチャ上の位置づけ]

## 📋 仕様トレーサビリティ

| 項目 | 関連資料 | 備考 |
|---|---|---|
| **設計判断** | [ADR-XXXX: タイトル](../docs-src/adr/XXXX-*.md) | 技術判断の根拠 |
| **ドメインモデル** | [用語集: セクション](../docs-src/glossary.md#セクション) | 用語定義・制約 |
| **単体テスト** | [ComponentName.test.tsx](../src/path/to/__tests__/ComponentName.test.tsx) | XX行、Xテスト |
| **統合テスト** | [integration.test.ts](../src/path/to/__tests__/integration.test.ts) | 他コンポーネントとの連携 |
| **品質方針** | [品質ガイド](../docs-src/quality/) | a11y/性能/i18n方針 |

## 🧪 テストカバレッジ
- **基本機能**: [主要機能のテスト内容]
- **アクセシビリティ**: [a11y要件のテスト内容]
- **エッジケース**: [境界値・異常系のテスト内容]
- **統合**: [他のコンポーネント・フックとの連携テスト]

## 🎯 品質指標
- **TypeScript**: [型安全性・TSDoc準拠状況]
- **a11y**: [Lighthouse目標値・axe-core結果]
- **Performance**: [Bundle影響・最適化状況]
- **今後の改善**: [検討中の改善点があれば記載]
        `,
      },
    },
  },
  // ... 以下は通常のストーリー定義
}
```

## 📚 記述ガイドライン

### 必須項目
- [ ] **設計判断**: 関連するADRへのリンク（ない場合はN/A）
- [ ] **ドメインモデル**: 用語集の該当セクションリンク  
- [ ] **単体テスト**: テストファイルパスと簡潔な統計（行数・テスト数）
- [ ] **品質方針**: 関連する品質ガイドへのリンク

### 推奨項目
- [ ] **統合テスト**: 他コンポーネントとの連携テスト（該当する場合）
- [ ] **テストカバレッジ**: 何をテストしているかの概要
- [ ] **品質指標**: TypeScript・a11y・Performanceの現状
- [ ] **今後の改善**: 既知の技術的負債・改善計画

### 記述のコツ
- **簡潔性**: 1行1項目、長くても2-3行に収める
- **具体性**: 抽象的な説明より具体的なリンク・数値を優先
- **最新性**: 実装と乖離しないよう定期的に更新
- **一貫性**: プロジェクト内で表記方法を統一

## 🔗 参考例

### 実装例
- **AmountInput**: [src/components/common/__stories__/AmountInput.stories.tsx](../src/components/common/__stories__/AmountInput.stories.tsx)

### 他の適用候補
- **AmountText**: 表示専用コンポーネントの例
- **useBudgetManager**: カスタムフックの例  
- **TransactionForm**: 複雑なフォームコンポーネントの例

## 🔄 運用・保守

### 更新タイミング
- **新機能追加**: コンポーネント機能拡張時に表を更新
- **テスト追加**: 新しいテストケース追加時にカバレッジ項目更新
- **ADR作成**: 新しいADRが該当コンポーネントに関連する場合
- **品質改善**: a11y・Performance改善時に指標更新

### 品質管理
- **月次**: リンク切れ・情報の陳腐化チェック
- **リリース前**: 全コンポーネントの表が最新状態か確認
- **レビュー**: PR時に表の更新漏れがないかチェック

### 改善・拡張
- **自動化**: 将来的にテスト統計の自動取得を検討
- **テンプレート**: よく使う表パターンをスニペット化
- **可視化**: Storybookでの表示をより見やすく改善

---

## 💡 Tips

### リンクパスについて
```typescript
// ✅ 良い例: 相対パスで確実にアクセス
"[ADR-0001](../docs-src/adr/0001-use-tsdoc-unified-documentation.md)"

// ❌ 悪い例: 絶対パスやHTTPリンクは変更に弱い
"[ADR-0001](https://github.com/user/repo/docs-src/adr/...)"
```

### 表のサイズ調整
```typescript
// 長い説明は備考欄ではなく、表の下に詳細セクションを作る
## 📋 仕様トレーサビリティ
[簡潔な表]

## 📖 詳細説明
[長い説明や補足情報]
```

### メンテナンスの負荷軽減
```typescript
// テスト統計は具体的な数値より「充実度」で表現
"| **単体テスト** | [Component.test.tsx](...) | 基本機能網羅 |"
// 数値は変更頻度が高いため保守負荷になりやすい
```

---

**作成日**: 2025-08-12  
**適用開始**: AmountInputから段階的に適用  
**関連**: [overview.mdx](../overview.mdx), [PRテンプレート](../../.github/PULL_REQUEST_TEMPLATE.md)